import type { Express } from "express";
import { createServer, type Server } from "http";
import {
  handleTranscriptExtraction,
  handleSummaryGeneration,
  handleGetVideoDetails,
  handleGetSummary,
  handleGetHistory,
  handleClearHistory
} from "./handlers";

export async function registerRoutes(app: Express): Promise<Server> {
  // API Route for transcript extraction
  app.post('/api/transcripts', handleTranscriptExtraction);

  // API Route for generating summary
  app.post('/api/summaries', handleSummaryGeneration);

  // API Route for getting video details
  app.get('/api/videos/:id', handleGetVideoDetails);

  // API Route for getting summary
  app.get('/api/summaries/:id', handleGetSummary);

  // API Route for getting history
  app.get('/api/history', handleGetHistory);

  // API Route for clearing history
  app.delete('/api/history', handleClearHistory);

  const httpServer = createServer(app);
  return httpServer;
}